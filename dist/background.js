(()=>{"use strict";const e="MISSING_ENV_VAR".BD_HOST||"http://localhost:3000",n="https://www.linkedin.com";var r;!function(e){e.MESSAGE="MESSAGE",e.LI_PROFILE="LINKEDIN_PROFILE",e.LI_CONNECTION="LINKED_CONNECTION",e.LI_TOTAL_CONNECTION="LINKED_TOTAL_CONNECTION",e.LI_GLOBAL_SEARCH="SEARCH_PROFILE",e.LI_LOCATION="LOCATION"}(r||(r={}));const t=(e,n)=>{return r=void 0,t=void 0,a=function*(){const r=yield(t="csrf_token",new Promise(((e,n)=>{chrome.storage.local.get([t],(n=>{n[t]?e(n[t]):e(null)}))})));var t;return r?yield fetch(`https://www.linkedin.com${e}`,Object.assign(Object.assign({},n),{headers:Object.assign(Object.assign({},n.headers),{"csrf-token":r})})).then((e=>{if(e.status>300)throw new Error(`error_${e.status}`);return e.json()})).catch((e=>{if(e instanceof Error){const n={message:e.message,stack:e.stack};console.error("Error occurred while calling LinkedIn API:",n)}else console.error("Error occurred while calling LinkedIn API:",JSON.stringify(e,null,2));if(e.message.startsWith("error_")){const[,n]=e.message.split("_");return{error:!0,code:Number(n)}}return null})):null},new((o=void 0)||(o=Promise))((function(e,n){function c(e){try{s(a.next(e))}catch(e){n(e)}}function i(e){try{s(a.throw(e))}catch(e){n(e)}}function s(n){var r;n.done?e(n.value):(r=n.value,r instanceof o?r:new o((function(e){e(r)}))).then(c,i)}s((a=a.apply(r,t||[])).next())}));var r,t,o,a};const o=()=>{return e=void 0,n=void 0,o=function*(){const e=yield t("/voyager/api/me",{method:"GET"});if("error"in e)throw new Error(`API Error: ${e.message||"Unknown error"} (Code: ${e.code})`);return console.log("Profile Response",e),e},new((r=void 0)||(r=Promise))((function(t,a){function c(e){try{s(o.next(e))}catch(e){a(e)}}function i(e){try{s(o.throw(e))}catch(e){a(e)}}function s(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r((function(e){e(n)}))).then(c,i)}s((o=o.apply(e,n||[])).next())}));var e,n,r,o};const a=e=>{return n=void 0,r=void 0,a=function*(){const n=yield t(`/voyager/api/graphql?includeWebMetadata=true&variables=(vanityName:${encodeURIComponent(e)})&queryId=voyagerIdentityDashProfiles.545b6b61da02e06975ba277b722ad219`,{method:"GET"});return console.log("LOcations",n),n},new((o=void 0)||(o=Promise))((function(e,t){function c(e){try{s(a.next(e))}catch(e){t(e)}}function i(e){try{s(a.throw(e))}catch(e){t(e)}}function s(n){var r;n.done?e(n.value):(r=n.value,r instanceof o?r:new o((function(e){e(r)}))).then(c,i)}s((a=a.apply(n,r||[])).next())}));var n,r,o,a};const c=()=>{return e=void 0,n=void 0,o=function*(){const e=yield t(`/voyager/api/graphql?includeWebMetadata=true&variables=(profileUrn:${encodeURIComponent("urn:li:fs_miniProfile:ACoAAD5odtwBzI2Ye867c8CfABtlYDBX4Zii8Jc")})&queryId=voyagerIdentityDashProfileCards.2d30279e53ca36147e201a6a55d89bb3\n    }`,{method:"GET"});return console.log("EDucation",e),e},new((r=void 0)||(r=Promise))((function(t,a){function c(e){try{s(o.next(e))}catch(e){a(e)}}function i(e){try{s(o.throw(e))}catch(e){a(e)}}function s(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r((function(e){e(n)}))).then(c,i)}s((o=o.apply(e,n||[])).next())}));var e,n,r,o};chrome.runtime.onInstalled.addListener((function(r){chrome.tabs.query({},(r=>{const t=r.filter((e=>e.url.includes(n))),o=r.filter((n=>n.url.includes(e)));if(t.length>0){const e=t[0];chrome.scripting.executeScript({target:{tabId:e.id},files:["/content_scripts/linkedin.js"]})}else chrome.tabs.create({url:n});if(o.length>0){const e=o[0];chrome.scripting.executeScript({target:{tabId:e.id},files:["/content_scripts/bd.js"]})}})),"install"==r.reason&&(chrome.storage.local.clear(),a("mustafa-kamal-250796252"),o(),c()),"update"==r.reason&&(a("mustafa-kamal-250796252"),o(),c())})),chrome.alarms.onAlarm.addListener((e=>{switch(e.name){case"ALARAMS_ON":{const e="mustafa-kamal-250796252";o(),a(e);break}}})),chrome.runtime.onMessageExternal.addListener(((e,n,c)=>{const{type:i,start:s,searchTerm:d,publicIdentifier:l}=e;switch(i){case r.MESSAGE:c({signal:!0});break;case r.LI_PROFILE:o().then((e=>{c({response:e})})).catch((e=>{c({error:"Failed to fetch LinkedIn profile data"})}));break;case r.LI_CONNECTION:((e=0)=>{return n=void 0,r=void 0,a=function*(){const n=yield t("/voyager/api/relationships/dash/connections?decorationId=com.linkedin.voyager.dash.deco.web.mynetwork.ConnectionListWithProfile-16&count=10&q=search&sortType=RECENTLY_ADDED&start="+10*e,{method:"GET"});if("error"in n)throw new Error(`API Error: ${n.message||"Unknown error"} (Code: ${n.code})`);return n},new((o=void 0)||(o=Promise))((function(e,t){function c(e){try{s(a.next(e))}catch(e){t(e)}}function i(e){try{s(a.throw(e))}catch(e){t(e)}}function s(n){var r;n.done?e(n.value):(r=n.value,r instanceof o?r:new o((function(e){e(r)}))).then(c,i)}s((a=a.apply(n,r||[])).next())}));var n,r,o,a})(s).then((e=>{c({response:e})})).catch((e=>{c({error:"Failed to fetch LinkedIn Connection data"})}));break;case r.LI_TOTAL_CONNECTION:(u=void 0,h=void 0,f=void 0,v=function*(){const e=yield t("/voyager/api/search/dash/clusters?decorationId=com.linkedin.voyager.dash.deco.search.SearchClusterCollection-1&count=0&origin=Communities&q=all&query=(queryParameters:(resultType:List(CONNECTIONS)),flagshipSearchIntent:MYNETWORK_CURATION_HUB)&start=0",{method:"GET"});if("error"in e)throw new Error(`API Error: ${e.message||"Unknown error"} (Code: ${e.code})`);return e},new(f||(f=Promise))((function(e,n){function r(e){try{o(v.next(e))}catch(e){n(e)}}function t(e){try{o(v.throw(e))}catch(e){n(e)}}function o(n){var o;n.done?e(n.value):(o=n.value,o instanceof f?o:new f((function(e){e(o)}))).then(r,t)}o((v=v.apply(u,h||[])).next())}))).then((e=>{c({response:e})})).catch((e=>{c({error:"Failed to fetch LinkedIn Total Connection data"})}));break;case r.LI_GLOBAL_SEARCH:{const{searchTerm:n}=e;(e=>function(e,n,r,t){return new(r||(r=Promise))((function(o,a){function c(e){try{s(t.next(e))}catch(e){a(e)}}function i(e){try{s(t.throw(e))}catch(e){a(e)}}function s(e){var n;e.done?o(e.value):(n=e.value,n instanceof r?n:new r((function(e){e(n)}))).then(c,i)}s((t=t.apply(e,n||[])).next())}))}(void 0,void 0,void 0,(function*(){if(!e)throw new Error("Search term is required!");const n=encodeURIComponent(e),r=yield t(`/voyager/api/graphql?variables=(query:${n})&queryId=voyagerSearchDashTypeahead.eeea0c1dfdf533272e9de4e98a59d725`,{method:"GET"});if("error"in r)throw new Error(`API Error: ${r.message||"Unknown error"} (Code: ${r.code})`);return r})))(n).then((e=>{c({response:e})})).catch((e=>{c({error:"Failed to fetch LinkedIn Search Profile data"})}));break}case r.LI_LOCATION:a(l).then((e=>{c({response:e})})).catch((e=>{c({error:"Failed to fetch LinkedIn Search Profile data"})}));break;case"AUTHENTICATION_LOGOUT":new Promise((e=>{chrome.storage.local.remove("AUTH_TOKEN",(()=>{e(!0)}))}))}var u,h,f,v}))})();