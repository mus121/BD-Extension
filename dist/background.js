(()=>{"use strict";const e="/voyager/api/me",t="/voyager/api/relationships/dash/connections",n="/voyager/api/graphql";var o=function(e,t,n,o){return new(n||(n=Promise))((function(r,a){function i(e){try{s(o.next(e))}catch(e){a(e)}}function c(e){try{s(o.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}s((o=o.apply(e,t||[])).next())}))};const r={get(e){return o(this,void 0,void 0,(function*(){return new Promise((t=>{chrome.storage.local.get([e],(n=>{t(n[e]||null)}))}))}))},set(e,t){return o(this,void 0,void 0,(function*(){return chrome.storage.local.set({[e]:t})}))},remove(e){return o(this,void 0,void 0,(function*(){return chrome.storage.local.remove(e)}))}};var a,i=function(e,t,n,o){return new(n||(n=Promise))((function(r,a){function i(e){try{s(o.next(e))}catch(e){a(e)}}function c(e){try{s(o.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}s((o=o.apply(e,t||[])).next())}))};class c{static makeRequest(e){return i(this,arguments,void 0,(function*(e,t={}){try{const n=yield r.get("csrf_token");if(!n)throw new Error("CSRF token not found");const o=yield fetch(`https://www.linkedin.com${e}`,Object.assign(Object.assign({},t),{headers:Object.assign(Object.assign({},t.headers),{"csrf-token":n})}));if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return{data:yield o.json()}}catch(e){return{error:{code:500,message:e instanceof Error?e.message:"Unknown error occurred"}}}}))}static getProfile(){return i(this,void 0,void 0,(function*(){return this.makeRequest(e)}))}static getConnections(){return i(this,arguments,void 0,(function*(e=0,n=10){return this.makeRequest(`${t}?decorationId=com.linkedin.voyager.dash.deco.web.mynetwork.ConnectionListWithProfile-16&q=search&start=${e}&count=${n}&sortType=RECENTLY_ADDED`)}))}static searchProfiles(e){return i(this,void 0,void 0,(function*(){const t=encodeURIComponent(e);return this.makeRequest(`${n}?variables=(query:${t})&queryId=voyagerSearchDashTypeahead.eeea0c1dfdf533272e9de4e98a59d725`)}))}}!function(e){e.FETCH_PROFILE="FETCH_PROFILE",e.FETCH_CONNECTIONS="FETCH_CONNECTIONS",e.FETCH_SEARCH="FETCH_SEARCH",e.SEARCH_PROFILES="SEARCH_PROFILES",e.ERROR="ERROR"}(a||(a={}));var s=function(e,t,n,o){return new(n||(n=Promise))((function(r,a){function i(e){try{s(o.next(e))}catch(e){a(e)}}function c(e){try{s(o.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}s((o=o.apply(e,t||[])).next())}))};chrome.runtime.onInstalled.addListener((()=>{chrome.alarms.create("dataSyncAlarm",{periodInMinutes:1})})),chrome.alarms.onAlarm.addListener((e=>s(void 0,void 0,void 0,(function*(){"dataSyncAlarm"===e.name&&(yield function(){return s(this,void 0,void 0,(function*(){try{const[e,t,n]=yield Promise.all([c.getProfile(),c.getConnections(0,50),c.searchProfiles("Mustafa")]);console.log("profile",e.data,"connections",t.data,"search",n.data)}catch(e){console.error("Data sync failed:",e)}}))}())})))),chrome.runtime.onMessageExternal.addListener(((e,t,n)=>(((e,t)=>{var n,o,r,i;n=void 0,o=void 0,i=function*(){switch(e.type){case a.FETCH_PROFILE:const n=yield c.getProfile();t(n);break;case a.FETCH_CONNECTIONS:const o=yield c.getConnections(e.payload.start,e.payload.count);t(o);break;case a.SEARCH_PROFILES:const r=yield c.searchProfiles(e.payload);t(r);break;default:t({error:{code:400,message:"Unknown message type"}})}},new((r=void 0)||(r=Promise))((function(e,t){function a(e){try{s(i.next(e))}catch(e){t(e)}}function c(e){try{s(i.throw(e))}catch(e){t(e)}}function s(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(a,c)}s((i=i.apply(n,o||[])).next())}))})({type:e,payload:t},n),!0)))})();