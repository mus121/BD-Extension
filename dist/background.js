(()=>{"use strict";const e="MISSING_ENV_VAR".BD_HOST||"http://localhost:3000",n="https://www.linkedin.com";var t;!function(e){e.MESSAGE="MESSAGE",e.LI_PROFILE="LINKEDIN_PROFILE",e.LI_CONNECTION="LINKED_CONNECTION",e.LI_TOTAL_CONNECTION="LINKED_TOTAL_CONNECTION",e.LI_GLOBAL_DROPDOWN="SEARCH_PROFILE",e.LI_LOCATION="LOCATION",e.LI_GLOBAL_PROFILES="GLOBAL_SEARCH_PROFILE"}(t||(t={}));const r=(e,n)=>{return t=void 0,r=void 0,i=function*(){const t=yield(r="csrf_token",new Promise(((e,n)=>{chrome.storage.local.get([r],(n=>{n[r]?e(n[r]):e(null)}))})));var r;return t?yield fetch(`https://www.linkedin.com${e}`,Object.assign(Object.assign({},n),{headers:Object.assign(Object.assign({},n.headers),{"csrf-token":t})})).then((e=>{if(e.status>300)throw new Error(`error_${e.status}`);return e.json()})).catch((e=>{if(e instanceof Error){const n={message:e.message,stack:e.stack};console.error("Error occurred while calling LinkedIn API:",n)}else console.error("Error occurred while calling LinkedIn API:",JSON.stringify(e,null,2));if(e.message.startsWith("error_")){const[,n]=e.message.split("_");return{error:!0,code:Number(n)}}return null})):null},new((o=void 0)||(o=Promise))((function(e,n){function a(e){try{s(i.next(e))}catch(e){n(e)}}function c(e){try{s(i.throw(e))}catch(e){n(e)}}function s(n){var t;n.done?e(n.value):(t=n.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,c)}s((i=i.apply(t,r||[])).next())}));var t,r,o,i};chrome.runtime.onInstalled.addListener((function(t){chrome.tabs.query({},(t=>{const r=t.filter((e=>e.url.includes(n))),o=t.filter((n=>n.url.includes(e)));if(r.length>0){const e=r[0];chrome.scripting.executeScript({target:{tabId:e.id},files:["/content_scripts/linkedin.js"]})}else chrome.tabs.create({url:n});if(o.length>0){const e=o[0];chrome.scripting.executeScript({target:{tabId:e.id},files:["/content_scripts/bd.js"]})}})),"install"==t.reason&&chrome.storage.local.clear(),t.reason})),chrome.alarms.onAlarm.addListener((e=>{e.name})),chrome.runtime.onMessageExternal.addListener(((e,n,o)=>{const{type:i,start:a,searchTerm:c,publicIdentifier:s,page:l}=e;switch(console.log({message:e}),i){case t.MESSAGE:o({signal:!0});break;case t.LI_PROFILE:(d=void 0,u=void 0,h=void 0,f=function*(){const e=yield r("/voyager/api/me",{method:"GET"});if("error"in e)throw new Error(`API Error: ${e.message||"Unknown error"} (Code: ${e.code})`);return console.log("Profile Response",e),e},new(h||(h=Promise))((function(e,n){function t(e){try{o(f.next(e))}catch(e){n(e)}}function r(e){try{o(f.throw(e))}catch(e){n(e)}}function o(n){var o;n.done?e(n.value):(o=n.value,o instanceof h?o:new h((function(e){e(o)}))).then(t,r)}o((f=f.apply(d,u||[])).next())}))).then((e=>{o({response:e})})).catch((e=>{o({error:"Failed to fetch LinkedIn profile data"})}));break;case t.LI_CONNECTION:((e=0)=>function(e,n,t,r){return new(t||(t=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,c)}s((r=r.apply(e,n||[])).next())}))}(void 0,void 0,void 0,(function*(){const n=yield r("/voyager/api/relationships/dash/connections?decorationId=com.linkedin.voyager.dash.deco.web.mynetwork.ConnectionListWithProfile-16&count=10&q=search&sortType=RECENTLY_ADDED&start="+10*e,{method:"GET"});if("error"in n)throw new Error(`API Error: ${n.message||"Unknown error"} (Code: ${n.code})`);return n})))(a).then((e=>{o({response:e})})).catch((e=>{o({error:"Failed to fetch LinkedIn Connection data"})}));break;case t.LI_TOTAL_CONNECTION:(function(e,n,t,r){return new(t||(t=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,c)}s((r=r.apply(e,n||[])).next())}))})(void 0,void 0,void 0,(function*(){const e=yield r("/voyager/api/search/dash/clusters?decorationId=com.linkedin.voyager.dash.deco.search.SearchClusterCollection-1&count=0&origin=Communities&q=all&query=(queryParameters:(resultType:List(CONNECTIONS)),flagshipSearchIntent:MYNETWORK_CURATION_HUB)&start=0",{method:"GET"});if("error"in e)throw new Error(`API Error: ${e.message||"Unknown error"} (Code: ${e.code})`);return e})).then((e=>{o({response:e})})).catch((e=>{o({error:"Failed to fetch LinkedIn Total Connection data"})}));break;case t.LI_GLOBAL_DROPDOWN:{const{searchTerm:n}=e;(e=>function(e,n,t,r){return new(t||(t=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,c)}s((r=r.apply(e,n||[])).next())}))}(void 0,void 0,void 0,(function*(){if(!e)throw new Error("Search term is required!");const n=encodeURIComponent(e),t=yield r(`/voyager/api/graphql?variables=(query:${n})&queryId=voyagerSearchDashTypeahead.eeea0c1dfdf533272e9de4e98a59d725`,{method:"GET"});if("error"in t)throw new Error(`API Error: ${t.message||"Unknown error"} (Code: ${t.code})`);return t})))(n).then((e=>{o({response:e})})).catch((e=>{o({error:"Failed to fetch LinkedIn Search Profile data"})}));break}case t.LI_LOCATION:(e=>function(e,n,t,r){return new(t||(t=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,c)}s((r=r.apply(e,n||[])).next())}))}(void 0,void 0,void 0,(function*(){const n=yield r(`/voyager/api/graphql?includeWebMetadata=true&variables=(vanityName:${encodeURIComponent(e)})&queryId=voyagerIdentityDashProfiles.545b6b61da02e06975ba277b722ad219`,{method:"GET"});return console.log("LOcations",n),n})))(s).then((e=>{o({response:e})})).catch((e=>{o({error:"Failed to fetch LinkedIn Search Profile data"})}));break;case t.LI_GLOBAL_PROFILES:((e,n=0)=>function(e,n,t,r){return new(t||(t=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,c)}s((r=r.apply(e,n||[])).next())}))}(void 0,void 0,void 0,(function*(){var t,o;const i=10*n,a=yield r(`/voyager/api/graphql?variables=(start:${i},origin:GLOBAL_SEARCH_HEADER,query:(keywords:${e},flagshipSearchIntent:SEARCH_SRP,queryParameters:List((key:resultType,value:List(PEOPLE)),(key:searchId,value:List(df200630-b31a-4170-b80e-98f1f0b0ffe0))),includeFiltersInResponse:false))&queryId=voyagerSearchDashClusters.cd5ee9d14d375bf9ca0596cfe0cbb926`,{method:"GET"}),c=(null===(t=a.data.searchDashClustersByAll)||void 0===t?void 0:t.elements)||[],s=(null===(o=a.data.searchDashClustersByAll)||void 0===o?void 0:o.paging)||[],l=c.flatMap((e=>(e.items||[]).map((e=>{var n,t,r,o,i,a,c,l,d,u,h;const f=e.item.entityResult;return{name:(null===(n=null==f?void 0:f.image)||void 0===n?void 0:n.accessibilityText)||"N/A",imageUrl:(null===(d=null===(l=null===(c=null===(a=null===(i=null===(o=null===(r=null===(t=null==f?void 0:f.image)||void 0===t?void 0:t.attributes)||void 0===r?void 0:r[0])||void 0===o?void 0:o.detailData)||void 0===i?void 0:i.nonEntityProfilePicture)||void 0===a?void 0:a.vectorImage)||void 0===c?void 0:c.artifacts)||void 0===l?void 0:l[0])||void 0===d?void 0:d.fileIdentifyingUrlPathSegment)||"N/A",location:(null===(u=null==f?void 0:f.secondarySubtitle)||void 0===u?void 0:u.text)||"N/A",headline:(null===(h=null==f?void 0:f.primarySubtitle)||void 0===h?void 0:h.text)||"N/A",totalcount:s||"N/A"}})))),d=l.filter((e=>"N/A"!==e.name&&"N/A"!==e.imageUrl&&"N/A"!==e.location&&"N/A"!==e.headline&&"N/A"!==e.totalcount));return console.log("Filtered Profiles Data:",d),d})))(c,l).then((e=>{o({response:e})}));break;case"AUTHENTICATION_LOGOUT":new Promise((e=>{chrome.storage.local.remove("AUTH_TOKEN",(()=>{e(!0)}))}))}var d,u,h,f}))})();